<!DOCTYPE html>
<html>
	<head>
		<title>GENERATE QR Code</title>
		<meta charset="UTF-8">
	</head>

	<body>
		<h3 id="target"></h3>
		<div id="output"></div>

		<br><br>
		<a href="#" class="button" id="btn-download">télécharger</a>
		<br><br>
		<a href="replay.html">recommencer </a> 

		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.5.2/jquery.min.js"></script>
		<script type="text/javascript" src="./jquery.qrcode.min.js"></script>
		<script>
		var url = "";

		// récupère les paramètres
		processUser();

		// génère le QR code
		jQuery(function(){
			jQuery('#output').qrcode(url);
		})

		// met à jour h3
		document.getElementById("target").innerHTML = "QR code généré pour l'adresse : "+url;

		// bouton download
		var button = document.getElementById('btn-download');
		button.addEventListener('click', function (e) {
			var dataURL = output.toDataURL('image/png');
			button.href = dataURL;
		});

		// fonction parametres
		function processUser()
		  {
			var parameters = location.search.substring(1).split("&");

			var temp = parameters[0].split("=");
			url = unescape(temp[1]);
			console.log(url);
		  }

		</script>
	</body>
</html>
